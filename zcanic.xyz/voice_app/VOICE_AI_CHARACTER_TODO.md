# 语音 AI 人格功能任务清单

## 项目概述

创建一个独立的 AI 人格对话功能，与现有的 Zcanic 聊天功能分开，提供语音合成能力。用户可以与这个特定的 AI 人格进行文本对话，并获得语音回复。

## 功能定位

- **独立功能**: 不集成到现有聊天系统中，而是作为独立的页面/功能
- **专有 AI 人格**: 设计独特的人格特征、对话风格和语音特点
- **语音互动**: 文本输入 → AI 回复 → 语音合成播放

## 开发任务分解

### 第一阶段：基础设计与规划 (2 天)

- [ ] **AI 人格设计**

  - [ ] 确定角色背景、性格特点和对话风格
  - [ ] 设计专用系统提示词
  - [ ] 选择合适的语音角色(Voicevox 角色 ID)

- [ ] **交互流程设计**
  - [ ] 设计用户对话界面
  - [ ] 规划对话状态管理
  - [ ] 设计语音播放交互

### 第二阶段：前端界面开发 (3 天)

- [ ] **新页面开发**

  - [ ] 创建`VoiceCompanion.jsx`页面组件
  - [ ] 实现头像和角色介绍展示
  - [ ] 设计对话消息展示区域

- [ ] **语音交互组件**

  - [ ] 开发`AudioPlayer.jsx`组件
  - [ ] 实现播放/暂停控制
  - [ ] 添加进度显示和音量控制

- [ ] **用户输入界面**
  - [ ] 实现消息输入框
  - [ ] 添加发送按钮和键盘快捷键
  - [ ] 设计加载状态显示

### 第三阶段：功能逻辑实现 (5 天)

- [ ] **状态管理**

  - [ ] 创建`VoiceCompanionContext.jsx`
  - [ ] 实现对话历史管理
  - [ ] 添加语音加载状态跟踪

- [ ] **API 服务**

  - [ ] 开发`voiceCompanionService.js`
  - [ ] 实现对话请求/响应处理
  - [ ] 添加错误处理和重试逻辑

- [ ] **后端接口**
  - [ ] 创建`voiceCompanionController.js`
  - [ ] 实现 AI 请求处理和提示词注入
  - [ ] 开发语音合成请求转发逻辑

### 第四阶段：用户体验优化 (4 天)

- [ ] **角色表现**

  - [ ] 添加打字动画效果
  - [ ] 实现语音播放时的视觉反馈
  - [ ] 优化对话风格一致性

- [ ] **个性化选项**

  - [ ] 添加语音设置(语速、音高)
  - [ ] 实现声音角色选择(如有多个)
  - [ ] 保存用户偏好

- [ ] **性能优化**
  - [ ] 实现语音缓存
  - [ ] 优化首次加载体验
  - [ ] 添加网络状态提示

### 第五阶段：测试与部署 (3 天)

- [ ] **测试**

  - [ ] 浏览器兼容性测试
  - [ ] 响应式布局测试
  - [ ] 语音功能边界测试

- [ ] **部署**
  - [ ] 服务端部署配置
  - [ ] 前端集成与路由设置
  - [ ] 监控与日志配置

## 技术关键点

1. **前端实现**

   - React 状态管理处理对话历史
   - 音频播放 API 处理语音播放
   - UI 动效提升交互体验

2. **后端实现**

   - AI 请求特定提示工程
   - 语音转换请求处理
   - 缓存机制提高性能

3. **语音服务**
   - 与 voice_app 微服务交互
   - 音频文件管理
   - 请求节流与错误处理

## 测试清单

- [ ] 对话是否保持人格一致性
- [ ] 语音播放是否流畅
- [ ] 网络不佳时的行为
- [ ] 移动设备兼容性
- [ ] 长时间对话性能

## 部署清单

- [ ] 确保 voice_app 服务正常运行
- [ ] 配置必要的环境变量
- [ ] 设置路由和导航链接
- [ ] 实现基本的监控告警
